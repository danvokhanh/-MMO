<!doctype html>
<html lang="en">
  <head>
    <!-- Font Awesome CSS -->
    <!-- nội dung gốc là trang đang được hiển thị  -->
    <link rel="canonical" href="https://dotsave.app/" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SaveFace.app</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">

    <link rel="stylesheet" href="stylesheets/style.css" />

  </head>

<body>
<header>
  <div class="logo" href="/">SaveFace</div>
    <a class="btn text-white" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <%= __('header_language')%>
    </a>
    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
      <a class="dropdown-item" href="/en"><%= __('english')%></a>
      <a class="dropdown-item" href="/vi"><%= __('vietnamese')%></a>
      <a class="dropdown-item" href="/ja"><%= __('japan')%></a>
      <a class="dropdown-item" href="/ko"><%= __('korea')%></a>
      <a class="dropdown-item" href="/it"><%= __('italy')%></a>
      <a class="dropdown-item" href="/ms"><%= __('malaysia')%></a>
      <a class="dropdown-item" href="/jv"><%= __('indonesia')%></a>
      <a class="dropdown-item" href="/ro"><%= __('romania')%></a>
    </div>
</header>

<div class="horizontal-rule"></div>

<!--Title-->
<h1 class="title"><%= __('main_title')%></h1>

<!--  dowload-->
<main>
  <form id="videoForm" class="layout_input mb-4">
    <label for="url"></label>
    <input name="url" id="url" class="inputText" type="text" placeholder="<%= __('input_placeholder')%>" >
    <button class="btn btn-outline-secondary button-paste" type="button" id="pasteButton">
      <i class="fas fa-paste"></i>
    </button>
    <button class="button btn btn-success"  type="submit"><%= __('button_text')%></button>
  </form>

<!--  error url-->
  <div class="d-flex justify-content-center">
    <div id="error-message" class="text-danger mt-2 bg-warning p-2 border rounded-pill w-50 text-center" style="display: none;"></div>
  </div>

  <!-- Loading Modal -->
  <div class="modal fade" id="loadingModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content bg-transparent border-0">
        <div class="modal-body text-center">
          <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

<!-- video and dowload -->
  <div class="d-flex justify-content-center">
    <div id="videoContainer" class="card " style="display: none;">
      <div class="card-body">
        <video id="videoPlayer" class="video" controls>
          <source id="videoSource" type="video/mp4">
          Trình duyệt của bạn không hỗ trợ thẻ video.
        </video>
        <div id="downloadLinks" class="mt-3 m-2"></div>
      </div>
    </div>
  </div>

  <!-- Custom JS -->
  <script>

<!--paste-->
    document.getElementById('pasteButton').addEventListener('click', async function() {
      try {
        const text = await navigator.clipboard.readText();
        document.getElementById('url').value = text;
      } catch (err) {
        console.error('Failed to read clipboard contents: ', err);
      }
    });

    document.getElementById('videoForm').addEventListener('submit', async function(event) {
      event.preventDefault();
      const url = document.getElementById('url').value;
      const errorMessage = document.getElementById('error-message');

      const facebookVideoRegex = /^(https?:\/\/)?(www\.)?(facebook\.com|fb\.watch)\/.+$/;

      if (!url) {
        errorMessage.textContent = '<%= __('input_placeholder-error')%>';
        errorMessage.style.display = 'block';
        return;
      } else if (!facebookVideoRegex.test(url)) {
        errorMessage.textContent = '<%= __('input_placeholder-error-1')%>';
        errorMessage.style.display = 'block';
        return;
      } else {
        errorMessage.style.display = 'none';
      }

      // Show loading modal
      $('#loadingModal').modal('show');

      try {
        const response = await fetch('/facebook-private-video-downloader', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ url })
        });
        const data = await response.json();

        if (!response.ok) {
          errorMessage.textContent = data.error;
          errorMessage.style.display = 'block';
          $('#loadingModal').modal('hide');
          return;
        }

        errorMessage.style.display = 'none';
        document.getElementById('videoForm').style.display = 'none'; // Hide the form
        document.getElementById('videoContainer').style.display = 'block'; // Show the video container
        const videoPlayer = document.getElementById('videoPlayer');
        document.getElementById('videoSource').src = data.hd.url;
        videoPlayer.load();

        const downloadLinks = document.getElementById('downloadLinks');


        if (data.hd || data.sd) {
          const headerRow = document.createElement('div');
          headerRow.className = 'header';

          const headerQuality = document.createElement('div');
          headerQuality.innerHTML = '<%= __('title_quality')%>';
          headerRow.appendChild(headerQuality);

          const headerRender = document.createElement('div');
          headerRender.innerHTML = 'Render <span title="Render information" class="show-guide text-success">[?]</span>';
          headerRow.appendChild(headerRender);

          const guideElement = document.getElementById('renderGuide');
          const showGuideBtn = headerRender.querySelector('.show-guide');

          showGuideBtn.addEventListener('click', () => {
            guideElement.scrollIntoView({ behavior: 'smooth' });
          });

          const headerDownload = document.createElement('div');
          headerDownload.innerHTML = '<%= __('button_save')%>';
          headerRow.appendChild(headerDownload);

          downloadLinks.appendChild(headerRow);
        }

        if (data.hd) {
          const hdRow = document.createElement('div');
          hdRow.className = 'rows';

          const hdQuality = document.createElement('div');
          hdQuality.innerHTML = data.hd.quality || '720p (HD)';
          hdRow.appendChild(hdQuality);

          const hdRender = document.createElement('div');
          hdRender.innerHTML = data.hd.render || 'No';
          hdRow.appendChild(hdRender);

          const hdDownload = document.createElement('div');
          const hdLink = document.createElement('a');
          hdLink.href = data.hd.url;
          hdLink.className = 'btn btn-secondary button-load';
          hdLink.innerHTML = '<%= __('button_save')%>';
          hdDownload.appendChild(hdLink);
          hdRow.appendChild(hdDownload);

          downloadLinks.appendChild(hdRow);
        }

        // Add a horizontal line if both HD and SD exist
        if (data.hd && data.sd) {
          const hr = document.createElement('hr');
          downloadLinks.appendChild(hr);
        }

        if (data.sd) {
          const sdRow = document.createElement('div');
          sdRow.className = 'rows';

          const sdQuality = document.createElement('div');
          sdQuality.innerHTML = data.sd.quality || '360p (SD)';
          sdRow.appendChild(sdQuality);

          const sdRender = document.createElement('div');
          sdRender.innerHTML = data.sd.render || 'No';
          sdRow.appendChild(sdRender);

          const sdDownload = document.createElement('div');
          const sdLink = document.createElement('a');
          sdLink.href = data.sd.url;
          sdLink.className = 'btn btn-secondary button-load';
          sdLink.innerHTML = '<%= __('button_save')%>';
          sdDownload.appendChild(sdLink);
          sdRow.appendChild(sdDownload);

          downloadLinks.appendChild(sdRow);
        }
        // Add a horizontal line if both HD and SD exist
        if (data.hd && data.sd) {
          const hr = document.createElement('hr');
          downloadLinks.appendChild(hr);
        }

        // Load video khác
        const reloadButton = document.createElement('button');
        reloadButton.className = 'btn btn-secondary button-reload';
        reloadButton.innerHTML = '<i class="fas fa-redo"></i> <%= __('button_load')%> ';
        reloadButton.addEventListener('click', () => {
          window.location.reload(true);
        });
        downloadLinks.appendChild(reloadButton);

        // Hide loading modal
        $('#loadingModal').modal('hide');
      } catch (error) {
        console.error('Error fetching video data:', error);
        errorMessage.textContent = 'An error occurred while fetching video data.';
        errorMessage.style.display = 'block';
        $('#loadingModal').modal('hide');
      }
    });
  </script>
</main>

  <!-- Giới thiệu-->
<div class="introduce">
  <h3 class="font-bold text-center mb-6 mt-2 text-2x text-primary-emphasis"><%= __('introduce_title1')%><samp class="title-introduce"><%= __('introduce_title2')%></samp></h3>
  <ol class="mb-4 ml-6 list-decimal">
    <li>
      <p class="mb-4 px-4"><%= __('introduce-1')%>
      </p></li><li>
      <p class="mb-4 px-4"><%= __('introduce-2')%>
      </p></li><li>
      <p class="mb-4 px-4"><%= __('introduce-3')%>
      </p></li><li>
      <p class="mb-4 px-4"><%= __('introduce-4')%>
      </p></li></ol>
  </div>

<!--Hướng dẫn sử dụng -->
<div id="renderGuide"  class="containers text-center mt-5">
  <h1 class="h3"><%= __('guide_title')%></h1>
  <div class="row mt-4">
    <div class="col-md-4 step step-1">
      <div class="number">1</div>
      <p><%= __('guide_steps-1')%></p>
    </div>
    <div class="col-md-4 step step-2">
      <div class="number">2</div>
      <p><%= __('guide_steps-2')%></p>
    </div>
    <div class="col-md-4 step step-3">
      <div class="number">3</div>
      <p><%= __('guide_steps-3')%></p>
    </div>
  </div>
</div>

<!--Hỏi và đáp-->
<div class="containers mt-5">
  <h2 class="text-center mb-4"><%= __('faq_title')%></h2>
  <div class="accordion" id="faqAccordion">
    <div class="card">
      <div class="card-header" id="headingOne">
        <h5 class="mb-0">
          <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-labelledby="headingOne" aria-controls="collapseOne">
            <%= __('question-1')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-1')%>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingTwo">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
            <%= __('question-2')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-2')%>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingThree">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
            <%= __('question-3')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-3')%>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingFour">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
            <%= __('question-4')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-4')%>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingFive">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
            <%= __('question-5')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-5')%>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingSix">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
            <%= __('question-6')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-6')%>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingSeven">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
            <%= __('question-7')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseSeven" class="collapse" aria-labelledby="headingSeven" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-7')%>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingEight">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
            <%= __('question-8')%>
            <i class="fas fa-chevron-down float-end"></i>
          </button>
        </h5>
      </div>
      <div id="collapseEight" class="collapse" aria-labelledby="headingEight" data-parent="#faqAccordion">
        <div class="card-body fst-italic text-primary fs-8">
          <%= __('answer-8')%>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Phần Footer -->
<footer class="bg-base-content py-4">
  <div class="container mx-auto px-4 text-white">
    <p class="text-black text-center">© 2024 <b><a>danvokhanh</a></b> - All rights reserved.</p>
  </div>
</footer>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>
</html>
